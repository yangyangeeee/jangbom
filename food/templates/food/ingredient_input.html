<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¬ë£Œ ì§ì ‘ ì¶”ê°€í•˜ê¸°</title>
</head>
<body>
  <h2>ì‹ì¬ë£Œë¥¼ ì‚´ê±°ì•¼</h2>

  {% if messages %}
    <ul>
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  <hr>

  <h3>ì¥ë°”êµ¬ë‹ˆ</h3>
  <ul>
    {% for ing in selected_ingredients %}
      <li>
        <form method="post" action="{% url 'food:delete_ingredient' ing.name %}" id="delete-form-{{ ing.id }}">
          {% csrf_token %}
          <input type="hidden" name="ingredient" value="{{ ing.name }}">
          <a href="#" onclick="document.getElementById('delete-form-{{ ing.id }}').submit(); return false;">
            {{ ing.name }}
          </a>
        </form>
      </li>
    {% empty %}
      <li>ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ì¬ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</li>
    {% endfor %}
  </ul>

  <hr>

  <!-- ğŸ” ì¬ë£Œ ê²€ìƒ‰ -->
  <form method="get" action="{% url 'food:ingredient_input' %}">
    <label for="search">ì¬ë£Œ ê²€ìƒ‰:</label>
    <input type="text" name="search" id="search" value="{{ request.GET.search }}" placeholder="ì˜ˆ: ëœì¥" />
    <button type="submit">ê²€ìƒ‰</button>
  </form>

  <hr>

  <h3>ì¬ë£Œ ë¦¬ìŠ¤íŠ¸</h3>

  <!-- ğŸ“¦ ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
  <form method="get" action="{% url 'food:ingredient_input' %}">
    <label for="category">ì¹´í…Œê³ ë¦¬ ì„ íƒ:</label>
    <select name="category" id="category" onchange="this.form.submit()">
      <option value="" {% if not selected_category %}selected{% endif %}>ì „ì²´</option>
      {% for cat in categories %}
        <option value="{{ cat.name }}" {% if cat.name == selected_category %}selected{% endif %}>{{ cat.name }}</option>
      {% endfor %}
    </select>
  </form>

  <ul>
    {% for ing in category_ingredients %}
      <li>
        <form method="post" action="{% url 'food:add_ingredient' %}" id="form-{{ ing.id }}">
          {% csrf_token %}
          <input type="hidden" name="ingredient" value="{{ ing.name }}">
          {% if selected_category %}
            <input type="hidden" name="category" value="{{ selected_category }}">
          {% endif %}
          <a href="#" onclick="document.getElementById('form-{{ ing.id }}').submit(); return false;" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            {% if ing.image %}
              <img src="{{ ing.image.url }}" alt="{{ ing.name }}" style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;" />
            {% endif %}
            <span>{{ ing.name }}</span>
          </a>
        </form>
      </li>
    {% empty %}
      <li>ì¡°ê±´ì— ë§ëŠ” ì¬ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</li>
    {% endfor %}
  </ul>

  <a href="{% url 'food:ingredient_result' %}">ì¶”ê°€ ì™„ë£Œ</a>
</body>
</html>